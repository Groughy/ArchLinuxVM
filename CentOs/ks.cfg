#version=DEVEL

# System authorization information


# Root password

rootpw GroughCentOs

# System timezone
timezone Europe/Paris --isUtc

# System language
lang fr_FR.UTF-8

# System keyboard
keyboard fr

# System bootloader configuration
bootloader --location=mbr

# Clear the Master Boot Record
zerombr

# Partition clearing information
clearpart --all --initlabel

# Disk partitioning information
part /boot --fstype="xfs" --size=1024
part pv.01 --fstype="lvmpv" --size=1 --grow
volgroup vg01 pv.01 --pesize=4096
logvol / --fstype="xfs" --name=root --grow --size=10240
logvol /var --fstype="xfs" --size=4096 --name=var
logvol /tmp --fstype="xfs" --size=4096 --name=tmp
logvol /home --fstype="xfs" --size=10240 --name=home
logvol swap --fstype="swap" --size=2048 --name=swap

# Network information
network --bootproto=dhcp --device=eth0 --ipv6=auto --activate

# Firewall configuration
firewall --enabled --service=ssh

# SELinux configuration
selinux --enforcing

# Installation logging level
logging --level=info

# Reboot after installation
reboot

# Packages to be installed
%packages
@^minimal-environment
sudo
bash-completion
nano
bridge-utils
%end

# Post-installation script
%post
# Enable and start SSH service
systemctl enable sshd
systemctl start sshd

# Create bridge network lxcbr0
cat <<EOF > /etc/sysconfig/network-scripts/ifcfg-lxcbr0
DEVICE=lxcbr0
TYPE=Bridge
BOOTPROTO=dhcp
ONBOOT=yes
DELAY=0
EOF

# Open SSH port in firewall
firewall-cmd --permanent --add-service=ssh
firewall-cmd --reload
%end